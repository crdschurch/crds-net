<div id="{% if include.isCard %}bitmovinPlayer{{video.slug | camelcase }}{% else %}VideoManager{% endif %}"
    data-video-player class="embed-responsive embed-responsive-16by9 relative">
    {% assign standby = site.content_blocks | where: "slug", "Live-Stream-Standby" | first %}
    {% if include.isStream %}
        {% include _preloader.html %}
        {{ standby.content_block }}
    {% endif %}
</div>
<script async src="https://cdn.bitmovin.com/player/web/8.10.1/bitmovinplayer.js"></script>
{% javascript_link_tag bitmovin async %}
<script async type="text/javascript">
    // if live-stream loads first
    ready();
    document.addEventListener("deferred-js-ready", ready);
    document.addEventListener("deferred-bitmovin-ready", ready);
    // if app-deferred loads first
    function ready() {
        if (window.deferredJSReady && window.defBitmovinLoaded) {
            bitmovinInit();
        }
    }

    function bitmovinInit() {
        var videoManagerID = `{{ include.isCard }}` ? `bitmovinPlayer{{video.slug | camelcase }}` : 'VideoManager';
        var bitmovinConfig = {
            title: `{{video.title}}`,
            url: `{{video.bitmovin_url}}`,
            id: videoManagerID,
            image: `{{ image | imgix: site.imgix }}`,
            isCard: `{{ include.isCard }}`,
            duration: `{{ video.duration }}`,
            isStream: `{{ include.isStream }}`,
            subtitles_url: '{{ video.transcription.url }}'
        }
        CRDS[videoManagerID] = new BitmovinManager(bitmovinConfig);
        var videoManagerReadyEvent = new Event(videoManagerID);
        document.dispatchEvent(videoManagerReadyEvent);
    }
</script>
