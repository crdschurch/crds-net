version: '3'
services:
  stream_tests:
    build: .
    container_name: cypress_live_stream_tests
    image: crdschurch/crds-net-live-stream-tests:${DOCKER_TAG:-local}
    ipc: host #If browser crashes, don't hang docker. https://github.com/cypress-io/cypress/issues/350
    environment:
      - VAULT_ROLE_ID=${VAULT_ROLE_ID}
      - VAULT_SECRET_ID=${VAULT_SECRET_ID}
    entrypoint: npm run ${config_file}